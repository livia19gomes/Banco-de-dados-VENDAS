/*1-*/
UPDATE DEBITOS 
SET SITUACAO_DEBITO = 'PENDENTE'
WHERE DATAVENCIMENTO < CURRENT_DATE 
AND SITUACAO_DEBITO NOT IN ('NEGOCIADO', 'PAGO')

/*2-*/
UPDATE DEBITOS 
SET SITUACAO_DEBITO = 'PENDENTE'
WHERE DATAVENCIMENTO < CURRENT_DATE AND SITUACAO_DEBITO <> 'PAGO'

/*3-*/
UPDATE DEBITOS 
SET DATAVENCIMENTO = DATEADD(YEAR, -5, DATAVENCIMENTO)
WHERE SITUACAO_DEBITO = 'NEGOCIADO'

/*4-*/
SELECT p.NOME , p.EMAIL , p.TELEFONE 
FROM PESSOA p 

/*5-*/
SELECT * FROM PRODUTO p 
WHERE PRECO_UNITARIO > 100

/*6-*/
SELECT * FROM VENDA v 
WHERE DATA_VENDA = '2022-12-07'

/*7-*/
SELECT p.DATA_NASCIMENTO, p.NOME, 2024 - EXTRACT(YEAR FROM p.DATA_NASCIMENTO) AS IDADE FROM PESSOA p 
WHERE p.ID_PESSOA IN (
	SELECT f.ID_PESSOA 
	FROM FORNECEDOR f 
	WHERE f.ID_FORNECEDOR NOT IN (
		SELECT p2.ID_FORNECEDOR 
		FROM PRODUTO p2
)
)

/*8-*/
SELECT * FROM cliente c 
	WHERE c.ID_CLIENTE IN (SELECT d.ID_CLIENTE FROM debitos d WHERE d.DATAVENCIMENTO < CURRENT_DATE)
	AND c.ID_Cliente IN (SELECT P.ID_CLIENTE FROM pagamento p)

/*9-NÃO FAZER*/

/*10-*/

	
/*11-*/
UPDATE PRODUTO 
SET PRECO_UNITARIO = PRECO_UNITARIO * 1.10
WHERE QUANTIDADE_ESTOQUE < 10

/*12-não fazer*/

/*13*/
UPDATE DEBITOS
SET SITUACAO_DEBITO = 'Pagos'
WHERE SITUACAO_DEBITO = 'Atrasado'
AND EXISTS (
    SELECT 1
    FROM PAGAMENTO p
    WHERE p.id_debito = DEBITOS.id_debito
)


/*14-* não fazer/

/*15*/
SELECT * FROM VENDA
WHERE data_venda >= '2023-12-01' AND data_venda < '2024-02-01'

/*16-*/
SELECT * FROM PRODUTO p 
WHERE QUANTIDADE_ESTOQUE BETWEEN 5 AND 20

/*17-*/
SELECT * FROM PESSOA p 
WHERE p.NOME LIKE 'A%'

/*18-*/
SELECT p.* FROM PRODUTO p
LEFT JOIN VENDA v ON id_produto = p.id_produto
WHERE id_produto IS NULL

/*19-*/
SELECT p.* FROM PRODUTO p
INNER JOIN VENDA v ON id_produto = p.id_produto
INNER JOIN CLIENTE c ON id_cliente = c.id_cliente
WHERE NOME IN ('Carla Souza', 'Larissa Ferreira')

/*20-*/

/*21*/


/*22*/
SELECT v.*, p.*
FROM VENDA v
JOIN PRODUTO p ON ID_PRODUTO = ID_PRODUTO 
WHERE p.nome = 'Placa de Captura'
